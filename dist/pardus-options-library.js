!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var s in i)("object"==typeof exports?exports:t)[s]=i[s]}}(self,(function(){return(()=>{"use strict";var t={d:(e,i)=>{for(var s in i)t.o(i,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:i[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{PardusOptions:()=>P,PardusOptionsUtility:()=>i});class i{static defaultSaveFunction(t,e){return GM_setValue(t,e)}static defaultGetFunction(t,e=null){return GM_getValue(t,e)}static defaultDeleteFunction(t){return GM_deleteValue(t)}static getUniverse(){switch(document.location.hostname){case"orion.pardus.at":return"orion";case"artemis.pardus.at":return"artemis";case"pegasus.pardus.at":return"pegasus";default:throw new Error("Unable to determine universe")}}static getVariableName(t){return`${this.getUniverse()}_${t}`}static getVariableValue(t,e=null){return this.defaultGetFunction(this.getVariableName(t),e)}static setVariableValue(t,e){return this.defaultSaveFunction(this.getVariableName(t),e)}static deleteVariableValue(t){return this.defaultDeleteFunction(this.getVariableName(t))}static setActiveTab(t){window.localStorage.setItem("pardusOptionsOpenTab",t),window.dispatchEvent(new window.Event("storage"))}static getImagePackUrl(){const t=String(document.querySelector("body").style.backgroundImage).replace(/url\("*|"*\)|[a-z0-9]+\.gif/g,"");return""!==t?t:"//static.pardus.at/img/std/"}static addGlobalListeners(){EventTarget.prototype.addPardusKeyDownListener=function(t,e=null,s,n=!1){const r=i.getVariableValue(t,e);if(!r)throw new Error(`No Pardus variable ${t} defined!`);Object.hasOwn(r,"disabled")||(this.pardusListeners||(this.pardusListeners=[]),this.pardusListeners.includes(`${r.code}${t}`)||(this.pardusListeners.push(`${r.code}${t}`),this.addEventListener("keydown",(t=>{t.isComposing||229===t.keyCode||t.repeat||t.keyCode===r.code&&s(t)}),n)))}}}class s{constructor(t){if(!t||""===t)throw new Error("Id cannot be empty.");if(!RegExp("^[a-zA-Z][\\w:.-]*$").test(t))throw new Error(`Id '${t}' is not a valid HTML identifier.`);this.id=t,this.afterRefreshHooks=[],this.beforeRefreshHooks=[]}addEventListener(t,e,i=!1){this.getElement()&&this.getElement().addEventListener(t,e,i),i&&Object.hasOwn(i,"ephemeral")&&i.ephemeral||this.addAfterRefreshHook((()=>{this.getElement()&&this.getElement().addEventListener(t,e,i)}))}removeEventListener(t,e){this.getElement()&&this.getElement().removeEventListener(t,e)}toString(){return`<div id='${this.id}'></div>`}beforeRefreshElement(){for(const t of this.beforeRefreshHooks)t()}afterRefreshElement(t={}){for(const e of this.afterRefreshHooks)e(t)}addAfterRefreshHook(t){this.afterRefreshHooks.push(t)}refreshElement(){this.beforeRefreshElement(),this.getElement().replaceWith(this.toElement()),this.afterRefreshElement()}getOffsetTop(){let t=this.getElement().offsetTop+this.getElement().offsetHeight,e=this.getElement().offsetParent;for(;null!==e;)t+=e.offsetTop,e=e.offsetParent;return t}getOffsetLeft(){let t=this.getElement().offsetLeft,e=this.getElement().offsetParent;for(;null!==e;)t+=e.offsetLeft,e=e.offsetParent;return t}getElement(){return document.getElementById(this.id)}toElement(){const t=document.createElement("template");return t.innerHTML=this.toString(),t.content.firstChild}appendChild(t){return document.getElementById(this.id).appendChild(t)}appendTableChild(t){return document.getElementById(this.id).firstChild.appendChild(t)}}class n extends s{constructor({id:t}){super(t),this.contents="",this.title="",this.addEventListener("click",(()=>{this.hide()}))}setContents({contents:t="",title:e=""}){this.contents=t,this.title=e,this.refreshElement()}setPosition({element:t,position:e="right"}){let i=15,s=-13;switch(e){case"left":i+=-220;break;case"er":i+=128;break;case"lf":i+=-160,s+=-310}this.getElement().style.top=`${t.getOffsetTop()+s}px`,this.getElement().style.left=`${t.getOffsetLeft()+i}px`}show(){this.getElement().removeAttribute("hidden")}hide(){this.getElement().setAttribute("hidden","")}toString(){return`<div id="${this.id}" hidden="" style="position: absolute; width: 200px; z-index: 100; border: 1pt black solid; background: #000000; padding: 0px;"><table class="messagestyle" style="background:url(${i.getImagePackUrl()}bgd.gif)" width="100%" cellspacing="0" cellpadding="3"><tbody><tr><td style="text-align:left;background:#000000;"><b>${this.title}</b></td></tr><tr><td style="text-align:left;">${this.contents}</td></tr><tr><td height="5"><spacer type="block" width="1" height="1"></spacer></td></tr><tr><td style="text-align:right;background:#31313A;"><b>GNN Library</b><img src="${i.getImagePackUrl()}info.gif" width="10" height="12" border="0"></td></tr></tbody></table></div>`}}class r extends s{constructor({id:t,hidden:e=!1}){super(t),this.hidden=e,this.labels=[],this.addAfterRefreshHook((()=>{for(const t of this.labels)t.afterRefreshElement()}))}addLabel({label:t}){this.labels.push(t),this.getElement()&&(this.appendChild(t.toElement()),t.afterRefreshElement())}show(){this.hidden=!1,this.refreshElement()}hide(){this.hidden=!0,this.refreshElement()}toString(){return this.hidden?`<tr id="${this.id}" cellspacing="0" cellpadding="0" border="0" hidden="">${this.labels.join("")}</tr>`:`<tr id="${this.id}" cellspacing="0" cellpadding="0" border="0">${this.labels.join("")}</tr>`}}class o extends s{constructor({id:t}){super(t),this.tabsRow=new r({id:`${this.id}-row`})}addLabel({label:t}){this.tabsRow.addLabel({label:t})}toString(){return`<table id="${this.id}" cellspacing="0" cellpadding="0" border="0" align="left"><tbody>${this.tabsRow}</tbody></table>`}}class d extends s{constructor({id:t}){super(t)}addContent({content:t}){this.appendChild(document.createElement("div").appendChild(t.toElement())),t.afterRefreshElement({maintainRefreshStatus:!0})}toString(){return`<tr id="${this.id}" cellspacing="0" cellpadding="0" border="0"></tr>`}}class a extends s{constructor({id:t,heading:e,active:s=!1,padding:n="0px"}){super(t),this.padding=n,this.heading=e,this.active=s,this.addEventListener("mouseover",(()=>{this.active||(this.getElement().style.backgroundImage=`url(${i.getImagePackUrl()}tabactive.png)`),this.getElement().style.cursor="default"})),this.addEventListener("mouseout",(()=>{this.active||(this.getElement().style.backgroundImage=`url(${i.getImagePackUrl()}tab.png)`,this.getElement().style.cursor="default")}))}toString(){const t=this.active?"tabactive":"tab";return`<td id="${this.id}" style="background: transparent url(&quot;${i.getImagePackUrl()}${t}.png&quot;) no-repeat scroll 0% 0%; background-size: cover; cursor: default; padding-left: ${this.padding}; padding-right: ${this.padding}" class="tabcontent">${this.heading}</td>`}setActive(){this.getElement().style.backgroundImage=`url('${i.getImagePackUrl()}tabactive.png')`,this.active=!0}setInactive(){this.getElement().style.backgroundImage=`url('${i.getImagePackUrl()}tab.png')`,this.active=!1}}class l extends s{constructor({id:t,disabled:e=!1}){super(t),this.disabled=e}disable(){this.setDisabled(!0),this.refreshElement()}enable(){this.setDisabled(!1),this.refreshElement()}setDisabled(t=!1){this.disabled=t}}class h extends l{constructor({id:t,premium:e=!1,disabled:i=!1,styleExtra:s="",actionText:n="",actionPerformedText:r=""}){super({id:t,disabled:i}),this.premium=e,this.premium?this.colour="#FFCC11":this.colour="#D0D1D9",this.backgroundColour="#00001C",this.disabled&&(this.colour="#B5B5B5",this.backgroundColour="#CCCCCC"),this.styleExtra=s,this.style=`color: ${this.colour};background-color: ${this.backgroundColour};${this.styleExtra}`,this.actionText=n,this.actionPerformedText=r}toString(){return`<input value="${this.actionText}" id="${this.id}" type="button" style="${this.style}" ${this.disabled?"disabled":""}>`}addClickListener(t,e=!1){this.getElement()&&this.getElement().addEventListener("click",t,e),e&&Object.hasOwn(e,"ephemeral")&&e.ephemeral||this.addAfterRefreshHook((()=>{this.getElement()&&this.getElement().addEventListener("click",t,e)}))}setActionText(t="",e=""){this.actionText=t,this.actionPerformedText=e,this.refreshElement()}displayClicked(){this.getElement().setAttribute("disabled","true"),this.getElement().value=this.actionPerformedText,this.getElement().setAttribute("style","color:green;background-color:silver"),setTimeout((()=>{this.getElement().removeAttribute("disabled"),this.getElement().value=this.actionText,this.premium?this.getElement().setAttribute("style","color:#FFCC11"):this.getElement().removeAttribute("style")}),2e3)}setDisabled(t=!1){this.disabled=t,this.disabled?(this.colour="#B5B5B5",this.backgroundColour="#CCCCCC"):(this.premium?this.colour="#FFCC11":this.colour="#D0D1D9",this.backgroundColour="#00001C"),this.style=`color: ${this.colour};background-color: ${this.backgroundColour};${this.styleExtra}`}disable(){this.setDisabled(!0),this.getElement()&&(this.getElement().setAttribute("disabled","true"),this.getElement().setAttribute("style",this.style))}enable(){this.setDisabled(!1),this.getElement()&&(this.getElement().removeAttribute("disabled"),this.getElement().setAttribute("style",this.style))}}class u extends h{constructor({id:t,premium:e=!1,disabled:i=!1}){super({id:t,premium:e,disabled:i,actionText:"Save",actionPerformedText:"Saved"})}displaySaved(){this.displayClicked()}}class c extends h{constructor({id:t,premium:e=!1,disabled:i=!1}){super({id:t,premium:e,disabled:i,actionText:"Reset",actionPerformedText:"Reset"})}displayReset(){this.displayClicked()}}class g extends l{constructor({id:t,premium:e=!1,resetButton:i=!1,disabled:s=!1}){super({id:t,disabled:s}),this.premium=e,this.saveButton=new u({id:`${this.id}-button`,premium:e,disabled:s}),this.resetButton=i?new c({id:`${this.id}-reset-button`,premium:e,disabled:s}):null}toString(){return`<tr id="${this.id}"><td align="right">${this.resetButton?`${this.resetButton}&nbsp`:""}${this.saveButton}</td></tr>`}setDisabled(t=!1){this.disabled=t,this.saveButton.setDisabled(t),this.resetButton&&this.resetButton.setDisabled(t)}displaySaved(){this.saveButton.displaySaved()}displayReset(){this.resetButton&&this.resetButton.displayReset()}addSaveEventListener(t){this.saveButton.addEventListener("click",t)}addResetEventListener(t){this.resetButton&&this.resetButton.addEventListener("click",t)}}class b extends h{constructor({id:t,premium:e=!1,disabled:i=!1}){super({id:t,premium:e,disabled:i,actionText:"Load",actionPerformedText:"Loaded"})}displayLoaded(){this.displayClicked()}}class p extends l{constructor({id:t,disabled:e=!1,defaultValue:i=""}){super({id:t,disabled:e}),this.defaultValue=i,this.styleExtra="",this.colour="#D0D1D9",this.backgroundColour="#00001C",this.disabled&&(this.colour="#B5B5B5",this.backgroundColour="#CCCCCC"),this.style=`color: ${this.colour};background-color: ${this.backgroundColour};${this.styleExtra}`}toString(){return`<input id="${this.id}" type="text" value="${this.getValue()}" style="${this.style}" ${this.disabled?"disabled":""}></input>`}save(){i.defaultSaveFunction(`${i.getVariableName(this.id)}`,this.getCurrentValue())}hasValue(){return!!i.defaultGetFunction(`${i.getVariableName(this.id)}`,!1)}disable(){this.setDisabled(!0),this.getInputElement()&&(this.getInputElement().removeAttribute("disabled"),this.getInputElement().setAttribute("style",this.style))}enable(){this.setDisabled(!1),this.getInputElement()&&(this.getInputElement().removeAttribute("disabled"),this.getInputElement().setAttribute("style",this.style))}setDisabled(t=!1){this.disabled=t,this.disabled?(this.colour="#B5B5B5",this.backgroundColour="#CCCCCC"):(this.colour="#D0D1D9",this.backgroundColour="#00001C"),this.style=`color: ${this.colour};background-color: ${this.backgroundColour};${this.styleExtra}`}getInputElement(){return document.getElementById(this.id)}getCurrentValue(){return this.getInputElement().value}getValue(){return i.defaultGetFunction(`${i.getVariableName(this.id)}`,this.defaultValue)}}class m extends l{constructor({id:t,premium:e=!1,disabled:i=!1,presetNumber:s}){super({id:t,disabled:i}),this.premium=e,this.saveButton=new u({id:`${this.id}-save-button`,premium:e,disabled:i}),this.loadButton=new b({id:`${this.id}-load-button`,premium:e,disabled:i}),this.presetNumber=s,this.label=new p({id:`${this.id}-label`,defaultValue:`Preset ${this.presetNumber}`,disabled:i}),this.hasValue()||this.loadButton.disable()}toString(){return`<tr id="${this.id}"><td align="left">${this.label}</input></td><td align="right">${this.loadButton} ${this.saveButton}</td></tr>`}setDisabled(t=!1){this.disabled=t,this.saveButton.setDisabled(t),this.loadButton.setDisabled(t),this.label.setDisabled(t)}displaySaved(){this.saveButton.displaySaved()}displayLoaded(){this.loadButton&&this.loadButton.displayLoaded()}hasValue(){return this.label.hasValue()}setFunctions(t){0!==t.length&&(this.addSaveEventListener((()=>{for(const e of t)e.saveValue(((t,i)=>{e.saveFunction(`preset-${this.presetNumber}-${t}`,i)}));this.displaySaved(),this.loadButton.enable(),this.label.save();const e=new Event("preset-save",{bubbles:!0});this.getElement().dispatchEvent(e)})),this.addLoadEventListener((()=>{for(const e of t)e.loadValue(e.getValue(((t,i)=>e.getFunction(`preset-${this.presetNumber}-${t}`,i))));this.displayLoaded();const e=new Event("preset-load",{bubbles:!0});this.getElement().dispatchEvent(e)})))}addSaveEventListener(t){this.saveButton.addEventListener("click",t)}addLoadEventListener(t){this.loadButton&&this.loadButton.addEventListener("click",t)}}class f extends l{constructor({id:t,premium:e=!1,disabled:i=!1,presets:s=0}){super({id:t,disabled:i}),this.premium=e,this.presets=[];for(let t=0;t<s;t+=1)this.presets.push(new m({id:`${this.id}-preset-row-${t}`,premium:e,disabled:i,presetNumber:t+1}))}setDisabled(t=!1){this.disabled=t;for(const e of this.presets)e.setDisabled(t)}toString(){if(0===this.presets.length)return"";let t=`<tr id="${this.id}"><td><table width="100%">`;for(const e of this.presets)t+=e;return`${t}</table></td></tr>`}setFunctions(t){for(const e of this.presets)e.setFunctions(t)}}class v extends s{constructor({id:t,description:e,title:i,tipBoxPosition:s="right"}){super(t),this.description=e,this.title=i,this.tipBoxPosition=s,this.addEventListener("mouseover",(()=>{this.tipBox=P.getDefaultTipBox(),this.tipBox.setContents({title:this.title,contents:this.description}),this.tipBox.setPosition({element:this,position:this.tipBoxPosition}),this.tipBox.show()})),this.addEventListener("mouseout",(()=>{this.tipBox.hide()}))}toString(){return`<a id="${this.id}" href="#" onclick="return false;"><img src="${i.getImagePackUrl()}info.gif" class="infoButton" alt=""></a>`}}class y extends l{constructor({id:t,variable:e,description:s="",defaultValue:n=!1,saveFunction:r=i.defaultSaveFunction,getFunction:o=i.defaultGetFunction,shallow:d=!1,reverse:a=!1,info:l=null,disabled:h=!1,styleExtra:u=""}){super({id:t,disabled:h}),this.variable=e,this.saveFunction=r,this.getFunction=o,this.description=s,this.info=l,this.defaultValue=n,this.inputId=`${this.id}-input`,this.shallow=d,this.reverse=a,this.styleExtra=u,this.colour="#D0D1D9",this.backgroundColour="#00001C",this.disabled&&(this.colour="#B5B5B5",this.backgroundColour="#CCCCCC"),this.style=`color: ${this.colour};background-color: ${this.backgroundColour};${this.styleExtra}`,null!==this.info?(this.infoElement=new v({id:`${this.id}-info`,description:this.info.description,title:this.info.title}),this.addAfterRefreshHook((()=>{this.infoElement.afterRefreshElement()}))):this.infoElement=""}toString(){return this.shallow?`<td id='${this.id}'>${this.getInnerHTML()}<label>${this.description}</label>${this.infoElement}</td>`:this.reverse?`<tr id='${this.id}'><td>${this.getInnerHTML()}</td><td><label for='${this.inputId}'>${this.description}</label>${this.infoElement}</td></tr>`:""===this.description?`<tr id='${this.id}'><td col="2">${this.getInnerHTML()}</td></tr>`:`<tr id='${this.id}'><td><label for='${this.inputId}'>${this.description}:</label>${this.infoElement}</td><td>${this.getInnerHTML()}</td></tr>`}getInnerHTML(){return""}getValue(t=null){return t&&"function"==typeof t?t(`${i.getVariableName(this.variable)}`,this.defaultValue):this.getFunction(`${i.getVariableName(this.variable)}`,this.defaultValue)}getCurrentValue(){return null}getInputElement(){return document.getElementById(this.inputId)}resetValue(){this.saveFunction(`${i.getVariableName(this.variable)}`,this.defaultValue)}saveValue(t=null){t&&"function"==typeof t?t(`${i.getVariableName(this.variable)}`,this.getCurrentValue()):this.disabled||this.saveFunction(`${i.getVariableName(this.variable)}`,this.getCurrentValue())}refreshStyle(){this.style=`color: ${this.colour};background-color: ${this.backgroundColour};${this.styleExtra}`,this.getInputElement()&&this.getInputElement().setAttribute("style",this.style)}disable(){this.setDisabled(!0),this.getInputElement()&&(this.getInputElement().setAttribute("disabled",""),this.getInputElement().setAttribute("style",this.style))}enable(){this.setDisabled(!1),this.getInputElement()&&(this.getInputElement().removeAttribute("disabled"),this.getInputElement().setAttribute("style",this.style))}setDisabled(t=!1){this.disabled=t,this.disabled?(this.colour="#B5B5B5",this.backgroundColour="#CCCCCC"):(this.colour="#D0D1D9",this.backgroundColour="#00001C"),this.style=`color: ${this.colour};background-color: ${this.backgroundColour};${this.styleExtra}`}loadValue(t){this.getInputElement().value=t,this.saveValue()}}class E extends y{getInnerHTML(){let t="";return!0===this.getValue()&&(t=" checked"),`<input id="${this.inputId}" type="checkbox"${t} style="${this.style}" ${this.disabled?"disabled":""}>`}getCurrentValue(){return this.getInputElement().checked}}class $ extends y{constructor({id:t,variable:e,description:s,defaultValue:n=0,saveFunction:r=i.defaultSaveFunction,getFunction:o=i.defaultGetFunction,disabled:d=!1,info:a=null,rows:l=3,cols:h=65}){super({id:t,variable:e,description:s,defaultValue:n,saveFunction:r,getFunction:o,info:a,disabled:d,styleExtra:"font-family: Helvetica, Arial, sans-serif;font-size:11px;"}),this.rows=l,this.cols=h}getInnerHTML(){return`<textarea id="${this.inputId}" autocomplete="off" autocorrect="off" spellcheck="false" ${0===this.rows?"":`rows="${this.rows}"`} ${0===this.cols?"":`cols="${this.cols}"`} style="${this.style}" ${this.disabled?"disabled":""}>${this.getValue()}</textarea>`}getCurrentValue(){return this.getInputElement().value}}class x extends y{constructor({id:t,variable:e,description:s,defaultValue:n=0,saveFunction:r=i.defaultSaveFunction,getFunction:o=i.defaultGetFunction,disabled:d=!1,min:a=0,max:l=0,step:h=1,info:u=null}){super({id:t,variable:e,description:s,defaultValue:n,saveFunction:r,getFunction:o,info:u,disabled:d}),this.minValue=a,this.maxValue=l,this.stepValue=h}getInnerHTML(){return`<input id="${this.inputId}" type="number" min="${this.minValue}" max="${this.maxValue}" step="${this.stepValue}" value="${this.getValue()}" style="${this.style}" ${this.disabled?"disabled":""}>`}getCurrentValue(){return this.getInputElement().value}}class B extends h{constructor({id:t,premium:e=!1,disabled:i=!1,styleExtra:s="",actionText:n="",actionPerformedText:r="",toggleText:o="",togglePerformedText:d="",toggled:a=!1}){super({id:t,premium:e,disabled:i,styleExtra:s,actionText:n,actionPerformedText:r}),this.toggled=a,this.defaultText=n,this.defaultPerformedText=r,this.toggleText=o,this.togglePerformedText=d,this.toggled&&(this.actionText=this.toggleText,this.actionPerformedText=this.togglePerformedText)}toggle(){this.toggled=!this.toggled,this.toggled?(this.actionText=this.toggleText,this.actionPerformedText=this.togglePerformedText):(this.actionText=this.defaultText,this.actionPerformedText=this.defaultPerformedText),this.refreshElement()}toString(){return`<input value="${this.actionText}" id="${this.id}" type="button" style="${this.style}" ${this.disabled?"disabled":""}>`}displayClicked(){this.getElement().setAttribute("disabled","true"),this.getElement().value=this.actionPerformedText,this.getElement().setAttribute("style","color:green;background-color:silver"),setTimeout((()=>{this.getElement().removeAttribute("disabled"),this.getElement().value=this.actionText,this.premium?this.getElement().setAttribute("style","color:#FFCC11"):this.getElement().removeAttribute("style")}),2e3)}addClickListener(t,e=!1){this.getElement()&&!this.toggled&&this.getElement().addEventListener("click",t,e),e&&Object.hasOwn(e,"ephemeral")&&e.ephemeral||this.addAfterRefreshHook((()=>{this.getElement()&&!this.toggled&&this.getElement().addEventListener("click",t,e)}))}addToggleClickListener(t,e=!1){this.getElement()&&this.toggled&&this.getElement().addEventListener("click",t,e),e&&Object.hasOwn(e,"ephemeral")&&e.ephemeral||this.addAfterRefreshHook((()=>{this.getElement()&&this.toggled&&this.getElement().addEventListener("click",t,e)}))}setDisabled(t=!1){this.disabled=t,this.disabled?(this.colour="#B5B5B5",this.backgroundColour="#CCCCCC"):(this.premium?this.colour="#FFCC11":this.colour="#D0D1D9",this.backgroundColour="#00001C"),this.style=`color: ${this.colour};background-color: ${this.backgroundColour};${this.styleExtra}`}disable(){this.setDisabled(!0),this.getElement()&&(this.getElement().setAttribute("disabled","true"),this.getElement().setAttribute("style",this.style))}enable(){this.setDisabled(!1),this.getElement()&&(this.getElement().removeAttribute("disabled"),this.getElement().setAttribute("style",this.style))}}class C extends B{constructor({id:t,premium:e=!1,disabled:i=!1}){super({id:t,premium:e,disabled:i,actionText:"Set Key",toggleText:"Cancel",styleExtra:"width:58px;"})}}class k extends B{constructor({id:t,premium:e=!1,disabled:i=!1,toggled:s=!1}){super({id:t,premium:e,disabled:i,toggled:s,actionText:"Disable",toggleText:"Enable",styleExtra:"width:58px;"})}}class F extends y{constructor({id:t,variable:e,description:i="",defaultValue:s=!1,saveFunction:n=PardusOptionsUtility.defaultSaveFunction,getFunction:r=PardusOptionsUtility.defaultGetFunction,shallow:o=!1,reverse:d=!1,info:a=null,disabled:l=!1}){const h=r(`${PardusOptionsUtility.getVariableName(e)}`,s),u=Object.hasOwn(h,"disabled")&&h.disabled;super({id:t,variable:e,description:i,defaultValue:s,saveFunction:n,getFunction:r,shallow:o,reverse:d,info:a,disabled:u,styleExtra:"width: 20px;padding: 2px;text-align: center;margin: 2px 7px 2px;"}),this.setKeyButton=new C({id:`${this.id}-setkey`,disabled:u}),this.disableButton=new k({id:`${this.id}-disable`,toggled:u}),this.boundCaptureKeyListener=this.captureKeyListener.bind(this),this.setKeyButton.addClickListener((()=>{document.getElementById(`${this.inputId}-key`).value="_",document.getElementById(`${this.inputId}-key`).style.color="lime",document.addEventListener("keydown",this.boundCaptureKeyListener,{once:!0,ephemeral:!0}),this.setKeyButton.toggle(),this.disableButton.disable()})),this.setKeyButton.addToggleClickListener((()=>{document.removeEventListener("keydown",this.boundCaptureKeyListener),this.setKeyButton.toggle(),this.disableButton.enable(),this.refreshElement()})),this.disableButton.addClickListener((()=>{this.disable(),this.disableButton.toggle()})),this.disableButton.addToggleClickListener((()=>{this.enable(),this.disableButton.toggle()})),this.addAfterRefreshHook((()=>{this.setKeyButton.afterRefreshElement(),this.disableButton.afterRefreshElement()}))}initialSetKeyListener(t=!0){this.setKeyButton.addEventListener("click",this.setKeyListener.bind(this),{once:!0,ephemeral:t})}setKeyListener(){this.setKeyButton.displayClicked(!0),document.getElementById(`${this.inputId}-key`).value="_",document.getElementById(`${this.inputId}-key`).style.color="lime",this.boundCaptureKeyListener=this.captureKeyListener.bind(this),this.boundCancelHandler=this.cancelHandler.bind(this),document.addEventListener("keydown",this.boundCaptureKeyListener,{once:!0,ephemeral:!0}),this.setKeyButton.addEventListener("click",this.boundCancelHandler,{once:!0,ephemeral:!0})}captureKeyListener(t){this.getInputElement().value=JSON.stringify({code:t.keyCode,key:t.code,description:t.key}),document.getElementById(`${this.inputId}-key`).value=this.getCurrentKeyDescription(),document.getElementById(`${this.inputId}-key`).style.color="#D0D1D9",this.disableButton.enable(),this.setKeyButton.toggle()}getInnerHTML(){let t=`<input id="${this.inputId}" type="text" hidden value='${JSON.stringify(this.getValue())}'>`;return t+=`<table width="100%"><tbody><tr><td align="left"><input id="${this.inputId}-key" type="text" cols="1" maxlength="1" readonly value="${this.getKeyDescription()}" style="${this.style}" ${this.disabled?"disabled":""}/></td><td align="right">${this.setKeyButton}</td><td align="right">${this.disableButton}</td></tr></tbody></table>`,t}disable(){this.setDisabled(!0),document.getElementById(`${this.inputId}-key`).removeAttribute("disabled"),document.getElementById(`${this.inputId}-key`).setAttribute("style",this.style),this.getInputElement().value=JSON.stringify({...this.getCurrentValue(),disabled:!0}),console.log(this.getInputElement().value)}enable(){this.setDisabled(!1),document.getElementById(`${this.inputId}-key`).removeAttribute("disabled"),document.getElementById(`${this.inputId}-key`).setAttribute("style",this.style);const t=this.getCurrentValue();delete t.disabled,this.getInputElement().value=JSON.stringify(t)}setDisabled(t=!1){this.disabled=t,this.disabled?(this.colour="#B5B5B5",this.backgroundColour="#CCCCCC",this.setKeyButton.disable()):(this.colour="#D0D1D9",this.backgroundColour="#00001C",this.setKeyButton.enable()),this.style=`color: ${this.colour};background-color: ${this.backgroundColour};${this.styleExtra}`}saveValue(t=null){t&&"function"==typeof t?t(`${PardusOptionsUtility.getVariableName(this.variable)}`,this.getCurrentValue()):this.saveFunction(`${PardusOptionsUtility.getVariableName(this.variable)}`,this.getCurrentValue())}getKey(){return this.getValue().key}getKeyDescription(){return this.getValue().description}getKeyCode(){return this.getValue().code}isDisabled(){const t=this.getValue();return!(!Object.hasOwn(t,"disabled")||!t.disabled)}getCurrentKey(){return this.getCurrentValue().key}getCurrentKeyDescription(){return this.getCurrentValue().description}getCurrentCode(){return this.getCurrentValue().code}getCurrentValue(){return JSON.parse(this.getInputElement().value)}}class w extends y{constructor({id:t,variable:e,description:s,defaultValue:n=null,saveFunction:r=i.defaultSaveFunction,getFunction:o=i.defaultGetFunction,disabled:d=!1,info:a=null,inheritStyle:l=!1,options:h=[]}){super({id:t,variable:e,description:s,defaultValue:n,saveFunction:r,getFunction:o,info:a,disabled:d}),this.options=h,l&&this.addEventListener("change",(()=>{this.updateSelectStyle()}))}getInnerHTML(){let t="";const e=this.getValue();let i=!1,s="";for(const n of this.options){const r=n.style?` style="${n.style}"`:"";i||n.value!==e&&(!n.default||!0!==n.default||e)?t+=`<option value=${n.value}${r}>${n.text}</option>`:(t+=`<option value=${n.value}${r} selected>${n.text}</option>`,i=!0,s=n.style?` style="${n.style}"`:"")}return t=`<select id="${this.inputId}"${s} style="${this.style}" ${this.disabled?"disabled":""}>${t}`,t}updateSelectStyle(){const t=this.getInputElement().selectedOptions[0].getAttribute("style");this.getInputElement().setAttribute("style",t)}getOptions(){return this.options}setOptions(t=[]){this.options=t}getCurrentValue(){return this.getInputElement().value}}class L extends s{constructor({id:t,description:e,saveFunction:s=i.defaultSaveFunction,getFunction:n=i.defaultGetFunction}){super(t),this.description=e,this.saveFunction=s,this.getFunction=n,this.options=[]}toString(){return`<tr id="${this.id}"><td>${this.description}</td><td>${this.getInnerHTML()}</td></tr>`}getInnerHTML(){let t="<table><tbody><tr>";for(const e of this.options)t+=e;return t+="</tr></tbody></table>",t}saveValue(){for(const t of this.options)t.saveValue()}addBooleanOption({variable:t,description:e,defaultValue:i=!1,saveFunction:s=this.saveFunction,getFunction:n=this.getFunction}){const r={id:`${this.id}-option-${this.options.length}`,variable:t,description:e,defaultValue:i,saveFunction:s,getFunction:n,shallow:!0},o=new E(r);return this.options.push(o),this.refreshElement(),o}}class T extends l{constructor({id:t,premium:e=!1,saveFunction:s=i.defaultSaveFunction,getFunction:n=i.defaultGetFunction,disabled:r=!1}){super({id:t,disabled:r}),this.premium=e,this.saveFunction=s,this.getFunction=n,this.options=[],this.disabled=r,this.addAfterRefreshHook((()=>{for(const t of this.options)t.afterRefreshElement()}))}setDisabled(t=!1){this.disabled=t;for(const e of this.options)e.setDisabled(t)}addBooleanOption(t){const e=new E({id:`${this.id}-option-${this.options.length}`,disabled:this.disabled,...t});return this.options.push(e),e}addTextAreaOption(t){const e=new $({id:`${this.id}-option-${this.options.length}`,disabled:this.disabled,...t});return this.options.push(e),e}addNumericOption(t){const e=new x({id:`${this.id}-option-${this.options.length}`,disabled:this.disabled,...t});return this.options.push(e),e}addKeyDownOption(t){const e=new F({id:`${this.id}-option-${this.options.length}`,disabled:this.disabled,...t});return this.options.push(e),e}addSelectOption(t){const e=new w({id:`${this.id}-option-${this.options.length}`,disabled:this.disabled,...t});return this.options.push(e),e}addGroupedOption({description:t,saveFunction:e=this.saveFunction,getFunction:i=this.getFunction}){const s=new L({id:`${this.id}-option-${this.options.length}`,disabled:this.disabled,description:t,saveFunction:e,getFunction:i});return this.options.push(s),s}toString(){return 0===this.options.length?`<tr id="${this.id}" style="display: none;"><td><table><tbody></tbody></table></td></tr>`:`<tr id="${this.id}"><td><table><tbody>${this.options.join("")}</tbody></table></td></tr>`}}class I extends s{constructor({id:t,description:e="",imageLeft:i="",imageRight:s=""}){super(t),this.backContainer="",this.description=e,this.imageLeft=i,this.imageRight=s,this.alignment="",this.frontContainer={styling:'style="display: none;"',id:"",setId(t){this.id=t},setStyle(t){this.styling=`style="${t}"`},toString:()=>""},this.frontContainer.setId(t)}addImageLeft(t){this.imageLeft=t,this.refreshElement()}addImageRight(t){this.imageRight=t,this.refreshElement()}setDescription(t){this.description=t,this.refreshElement()}setAlignment(t){this.alignment=t,this.refreshElement()}toString(){let t=`<tr id=${this.id} style=''><td><table><tbody><tr>`;return this.imageLeft&&""!==this.imageLeft&&(t=`${t}<td><img src="${this.imageLeft}"></td>`),t=""===this.alignment?""===this.imageLeft&&""===this.imageRight?`${t}<td align="left">${this.description}</td>`:`${t}<td align="center">${this.description}</td>`:`${t}<td align="${this.alignment}">${this.description}</td>`,this.imageRight&&""!==this.imageRight&&(t=`${t}<td><img src="${this.imageRight}"></td>`),`${t}</tr></tbody></table></td></tr>`}}class V extends l{constructor({id:t,heading:e,premium:s=!1,description:n="",imageLeft:r="",imageRight:o="",saveFunction:d=i.defaultSaveFunction,getFunction:a=i.defaultGetFunction,refresh:l=!0,resetButton:h=!1,presets:u=0,disabled:c=!1}){super({id:t,disabled:c}),this.heading=e,this.premium=s,this.saveFunction=d,this.getFunction=a,this.refresh=l,this.resetButton=h,this.disabled=c;const b=s?'<th class="premium">':"<th>";this.frontContainer=`<form id="${this.id}" action="none"><table style="background:url(${i.getImagePackUrl()}bgd.gif)" width="100%" cellpadding="3" align="center"><tbody><tr>${b}${e}</th></tr>`,this.backContainer="</tbody></table></form>",this.innerHtml="",this.description=new I({id:`${this.id}-description`,description:n,imageLeft:r,imageRight:o}),this.optionsGroup=new T({id:`${this.id}-options-group`,premium:s,saveFunction:d,getFunction:a,disabled:c}),this.saveButtonRow=new g({id:`${this.id}-save`,premium:s,resetButton:h,disabled:c}),this.presets=new f({id:`${this.id}-presets`,premium:s,presets:u,disabled:c}),this.addAfterRefreshHook((t=>{t.maintainRefreshStatus||(this.refresh=!0)})),this.addAfterRefreshHook((()=>{this.optionsGroup.afterRefreshElement(),this.saveButtonRow.afterRefreshElement()})),this.addAfterRefreshHook((()=>{this.setFunctions()}))}toString(){return 0===this.optionsGroup.options.length?this.frontContainer+this.description+this.innerHtml+this.optionsGroup+this.backContainer:this.frontContainer+this.description+this.innerHtml+this.optionsGroup+this.saveButtonRow+this.presets+this.backContainer}setFunctions(){0!==this.optionsGroup.options.length&&(this.saveButtonRow.addSaveEventListener((()=>{for(const t of this.optionsGroup.options)t.saveValue();this.saveButtonRow.displaySaved();const t=new Event("save");this.getElement().dispatchEvent(t)})),this.saveButtonRow.addResetEventListener((()=>{for(const t of this.optionsGroup.options)t.resetValue();this.saveButtonRow.displayReset(),this.optionsGroup.refreshElement();const t=new Event("reset");this.getElement().dispatchEvent(t)}))),this.presets.setFunctions(this.optionsGroup.options)}setDisabled(t=!1){this.disabled=t,this.optionsGroup.setDisabled(t),this.saveButtonRow.setDisabled(t),this.presets.setDisabled(t)}addSaveEventListener(t){return this.saveButtonRow.addSaveEventListener(t)}addBooleanOption({refresh:t=this.refresh,...e}){const i=this.optionsGroup.addBooleanOption(e);return t&&this.refreshElement(),i}addTextAreaOption({refresh:t=this.refresh,...e}){const i=this.optionsGroup.addTextAreaOption(e);return t&&this.refreshElement(),i}addNumericOption({refresh:t=this.refresh,...e}){const i=this.optionsGroup.addNumericOption(e);return t&&this.refreshElement(),i}addKeyDownOption({refresh:t=this.refresh,...e}){const i=this.optionsGroup.addKeyDownOption(e);return t&&this.refreshElement(),i}addSelectOption({refresh:t=this.refresh,...e}){const i=this.optionsGroup.addSelectOption(e);return t&&this.refreshElement(),i}addGroupedOption({description:t,saveFunction:e=this.saveFunction,getFunction:i=this.getFunction,refresh:s=this.refresh}){const n={description:t,saveFunction:e,getFunction:i},r=this.optionsGroup.addGroupedOption(n);return s&&this.refreshElement(),r}}class S extends s{constructor({id:t,content:e=null,saveFunction:s=i.defaultSaveFunction,getFunction:n=i.defaultGetFunction,refresh:r=!0,active:o=!0}){super(t),this.content=e,this.saveFunction=s,this.getFunction=n,this.leftBoxes=[],this.rightBoxes=[],this.topBoxes=[],this.bottomBoxes=[],this.refresh=r,this.active=o,this.addAfterRefreshHook((t=>{t.maintainRefreshStatus||(this.refresh=!0)})),this.addAfterRefreshHook((()=>{for(const t of this.topBoxes)t.afterRefreshElement();for(const t of this.leftBoxes)t.afterRefreshElement();for(const t of this.rightBoxes)t.afterRefreshElement();for(const t of this.bottomBoxes)t.afterRefreshElement()}))}addBox({top:t=!1,bottom:e=!1,...i}){let s=null;return s=t?this.addBoxTop(i):e?this.addBoxBottom(i):this.leftBoxes.length<=this.rightBoxes.length?this.addBoxLeft(i):this.addBoxRight(i),s}addBoxBottom({refresh:t=this.refresh,...e}){const i=new V({id:`${this.id}-bottom-box-${this.bottomBoxes.length}`,refresh:t,...e});return this.bottomBoxes.push(i),t&&this.refreshElement(),i}addBoxTop({refresh:t=this.refresh,...e}){const i=new V({id:`${this.id}-top-box-${this.topBoxes.length}`,refresh:t,...e});return this.topBoxes.push(i),t&&this.refreshElement(),i}addBoxLeft({refresh:t=this.refresh,...e}){const i=new V({id:`${this.id}-left-box-${this.leftBoxes.length}`,refresh:t,...e});return this.leftBoxes.push(i),t&&this.refreshElement(),i}addBoxRight({refresh:t=this.refresh,...e}){const i=new V({id:`${this.id}-right-box-${this.rightBoxes.length}`,refresh:t,...e});return this.rightBoxes.push(i),t&&this.refreshElement(),i}addPremiumBox(t){return this.addBox({premium:!0,...t})}addPremiumBoxLeft(t){return this.addBoxLeft({premium:!0,...t})}addPremiumBoxRight(t){return this.addBoxRight({premium:!0,...t})}toString(){if(null!==this.content)return this.content;const t=this.active?"":"hidden";return`<tr id="${this.id}" ${t}><td><table width="100%" align="center"><tbody><tr><td id="${this.id}-top" colspan="3" valign="top">${this.topBoxes.join("<br><br>")}${this.topBoxes.length>0?"<br><br>":""}</td></tr><tr><td id="${this.id}-left" width="350" valign="top">${this.leftBoxes.join("<br><br>")}</td><td width="40"></td><td id="${this.id}-right" width="350" valign="top">${this.rightBoxes.join("<br><br>")}</td></tr><tr><td id="${this.id}-bottom" colspan="3" valign="top">${this.bottomBoxes.length>0?"<br><br>":""}${this.bottomBoxes.join("<br><br>")}</td></tr></tbody></table></td></tr>`}setActive(){this.active=!0,this.getElement().removeAttribute("hidden")}setInactive(){this.active=!1,this.getElement().setAttribute("hidden","")}}class R{constructor({id:t,label:e,saveFunction:s=i.defaultSaveFunction,getFunction:n=i.defaultGetFunction,refresh:r=!0,active:o=!1,padding:d}){this.id=t,this.active=o,this.label=new a({id:`${this.id}-label`,heading:e,active:this.active,padding:d}),this.content=new S({id:`${this.id}-content`,saveFunction:s,getFunction:n,refresh:r,active:this.active})}setActive(){!0!==this.active&&(this.active=!0,this.label.setActive(),this.content.setActive())}setInactive(){!1!==this.active&&(this.active=!1,this.label.setInactive(),this.content.setInactive())}afterRefreshElement(t){this.label.afterRefreshElement(t),this.content.afterRefreshElement(t)}getLabel(){return this.label}getContent(){return this.content}toString(){return this.content.toString()}}class A extends s{constructor({id:t}){super(t)}toString(){return`<tr id="${this.id}"><td align="right" style="font-size:11px;color:#696988;padding-right:7px;padding-top:5px">Version ${GM_info.script.version}</td></tr>`}}class D extends s{constructor({id:t,heading:e,defaultLabel:s="Default tab",content:n=null,saveFunction:o=i.defaultSaveFunction,getFunction:d=i.defaultGetFunction,refresh:a=!0}){super(t),this.heading=e,this.content=n,this.saveFunction=o,this.getFunction=d,this.subTabsRow=new r({id:`${this.id}-tabsrow`}),this.refresh=a,this.subTabs=[],this.defaultTab=this.addSubTab({label:s,saveFunction:this.saveFunction,getFunction:this.getFunction,refresh:!1,active:!0}),this.versionRow=new A({id:`${this.id}-versionrow`}),this.addAfterRefreshHook((t=>{t.maintainRefreshStatus||(this.refresh=!0)})),this.addAfterRefreshHook((t=>{if(this.refresh||!t.maintainRefreshStatus)for(const e of this.subTabs)e.afterRefreshElement(t)}))}addSubTab({label:t,saveFunction:e=this.saveFunction,getFunction:i=this.getFunction,refresh:s=this.refresh,active:n=!1,padding:r}){const o=new R({id:`${this.id}-subtab-${this.subTabs.length}`,label:t,saveFunction:e,getFunction:i,refresh:s,active:n,padding:r}),d=o.getContent(),a=o.getLabel();return this.subTabsRow.addLabel({label:a}),this.subTabs.push(o),a.addEventListener("click",(()=>{this.setActiveSubTab(o.id)})),s&&this.refreshElement(),d}setActiveSubTab(t){for(const e of this.subTabs)e.id===t?e.setActive():e.setInactive()}addBox(t){return this.defaultTab.addBox(t)}addBoxBottom(t){return this.defaultTab.addBoxBottom(t)}addBoxTop(t){return this.defaultTab.addBoxTop(t)}addBoxLeft(t){return this.defaultTab.addBoxLeft(t)}addBoxRight(t){return this.defaultTab.addBoxRight(t)}addPremiumBox(t){return this.defaultTab.addPremiumBox(t)}addPremiumBoxLeft(t){return this.defaultTab.addPremiumBoxLeft(t)}addPremiumBoxRight(t){return this.defaultTab.addPremiumBoxRight(t)}setActive(){this.getElement().removeAttribute("hidden")}setInactive(){this.getElement().setAttribute("hidden","")}toString(){if(null!==this.content)return this.content;const t=this.subTabs.length>1?"":"hidden",e=this.subTabs.length>1?'class="tabstyle"':"";return`<table id="${this.id}" hidden class="tabstyle" style="background:url(${i.getImagePackUrl()}bgdark.gif)" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><div align="center"><h1>${this.heading}</h1></div></td></tr><tr><td><table width="100%" align="center" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><table cellspacing="0" cellpadding="0" border="0" ${t}><tbody>${this.subTabsRow}</tbody></table></td></tr><tr><td><table ${e} cellspacing="0" cellpadding="0" border="0"><tbody>${this.subTabs.join("")}</tbody></table></td></tr></tbody></table></td></tr>${this.versionRow}</tbody></table>`}}class O{constructor({id:t,heading:e,content:s=null,saveFunction:n=i.defaultSaveFunction,getFunction:r=i.defaultGetFunction,refresh:o=!0,defaultLabel:d}){this.id=t,this.heading=e,this.content=new D({id:`options-content-${this.id}`,heading:e,content:s,saveFunction:n,getFunction:r,refresh:o,defaultLabel:d}),this.label=new a({id:`${this.id}-label`,heading:e}),this.active=!1,this.saveFunction=n,this.getFunction=r}addListeners(){this.getLabel().addEventListener("click",(()=>i.setActiveTab(this.id)),!0),window.addEventListener("storage",(()=>{window.localStorage.getItem("pardusOptionsOpenTab")!==this.id||this.active||this.setActive(),window.localStorage.getItem("pardusOptionsOpenTab")!==this.id&&this.active&&this.setInactive()}))}setActive(){this.label.setActive(),this.content.setActive(),this.active=!0}setInactive(){this.label.setInactive(),this.content.setInactive(),this.active=!1}getContent(){return this.content}getLabel(){return this.label}}class P{static init(){if(document.getElementById("options-area"))return;const t=document.getElementsByTagName("table")[2],e=t.parentNode;t.setAttribute("id","options-content-pardus-default"),t.setAttribute("class","tabstyle"),t.remove(),e.appendChild(this.getPardusOptionsElement());const s=this.createDefaultTipBox();e.appendChild(s.toElement()),this.addTab({id:"pardus-default",heading:"Pardus Options",content:t.outerHTML,refresh:!1}),i.setActiveTab("pardus-default")}static version(){return 1.6}static createDefaultTipBox(){return new n({id:"options-default-tip-box"})}static getDefaultTipBox(){const t=this.createDefaultTipBox();return t.refreshElement(),t}static getTabsElement(){return new o({id:"options-tabs"})}static getContentElement(){return new d({id:"options-content"})}static getPardusOptionsElement(){const t=document.createElement("template");return t.innerHTML=`<table id="options-area" cellspacing="0" cellpadding="0" border="0"><tbody><tr cellspacing="0" cellpadding="0" border="0"><td>${this.getTabsElement()}</td></tr>${this.getContentElement()}</tbody></table>`,t.content.firstChild}static addTab({id:t,heading:e,content:s=null,saveFunction:n=i.defaultSaveFunction,getFunction:r=i.defaultGetFunction,refresh:o=!0,defaultLabel:d}){const a=new O({id:t,heading:e,content:s,saveFunction:n,getFunction:r,refresh:o,defaultLabel:d});if(document.getElementById(a.id))throw new Error(`Tab '${a.id}' already exists!`);return this.getTabsElement().addLabel({label:a.getLabel()}),this.getContentElement().addContent({content:a.getContent()}),a.addListeners(),a.getContent()}}return"/options.php"===document.location.pathname&&P.init(),i.addGlobalListeners(),e})()}));